<form [formGroup]="userForm" (ngSubmit)="onSubmit()">
  <div *ngFor="let field of dataKeys">
    <ng-container>
      <p class="field-key">{{ field }}:</p>
      <!-- INPUT -->
      <div>
        <mat-form-field *ngIf="getType(field) === 'input' && field === 'name'" appearance="fill">
          <mat-label>{{field}}</mat-label>
          <input matInput type='text' [formControlName]="field">
        </mat-form-field>
      </div>

      <div>
        <mat-form-field *ngIf="getType(field) === 'input' && field === 'password'">
          <input matInput type="text" [formControlName]="field" />
        </mat-form-field>
      </div>
      <!-- DROPDOWN -->
      <mat-form-field *ngIf="getType(field) === 'dropdown' && field==='state'" appearance="fill">
        <mat-label>{{field}}</mat-label>
        <mat-select [formControlName]="field">
          <mat-option value="ap">Andhra Pradesh</mat-option>
        </mat-select>
      </mat-form-field>
    </ng-container>
  </div>
  <button mat-raised-button>submit</button>
</form>

<mat-card>
  <mat-card-content>
    <button mat-stroked-button (click)="onAddNewRow()">Add row</button>
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z1">
      <ng-container *ngFor="let column of columnsToDisplay" [matColumnDef]="column">
        <th mat-header-cell *matHeaderCellDef>
          {{column}}
        </th>
        <td mat-cell *matCellDef="let element">
          <ng-container *ngIf="element.isEditable; else viewMode">
           <mat-form-field>
             <input matInput [(ngModel)]="element[columsToDataMapping[column]]"
              [ngModelOptions]="{ standalone: true }" />
           </mat-form-field>
          </ng-container>

          <ng-template #viewMode>
            {{ element[columsToDataMapping[column]] }}
          </ng-template>
        </td>
      </ng-container>
      <ng-container matColumnDef="edit">
        <th mat-header-cell *matHeaderCellDef>Edit</th>
        <td mat-cell *matCellDef="let element">
          <button mat-button (click)="onEditClick(element)">
            <mat-icon>
              edit
            </mat-icon>
          </button>
        </td>
      </ng-container>
      <ng-container matColumnDef="cancel">
        <th mat-header-cell *matHeaderCellDef>Cancel</th>
        <td mat-cell *matCellDef="let element">
          <button mat-button (click)="onCancelClick(element)">
            <mat-icon>
              cancel
            </mat-icon>
          </button>
        </td>
      </ng-container>
      <ng-container matColumnDef="delete">
        <th mat-header-cell *matHeaderCellDef>Delete</th>
        <td mat-cell *matCellDef="let element">
          <button mat-button>
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithAction"></tr>
      <tr mat-row *matRowDef="let row; columns:columnsToDisplayWithAction"></tr>
    </table>
  </mat-card-content>
</mat-card>